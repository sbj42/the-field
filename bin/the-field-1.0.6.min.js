var TheField;TheField=(()=>{"use strict";var t={172:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FieldOfViewMap=void 0;var r=i(842),n=1e-5,o=new r.Offset,s=function(){function t(t,e){this._size=new r.Size,this._size.set(t,e),this._tileFlags=new Array(1+(this._size.area>>5)).fill(0)}return t.prototype.addBody=function(t,e){o.set(t,e);var i=this._size.index(o);this._tileFlags[i>>5]|=1<<(31&i)},t.prototype.removeBody=function(t,e){o.set(t,e);var i=this._size.index(o);this._tileFlags[i>>5]&=~(1<<(31&i))},t.prototype.getBody=function(t,e){o.set(t,e);var i=this._size.index(o);return 0!=(this._tileFlags[i>>5]&1<<(31&i))},t.prototype.getFieldOfView=function(t,e,i){var n=new r.Offset(t,e),o=new r.Rectangle(n.x-i,n.y-i,2*i+1,2*i+1),s=new r.MaskRect(o);return s.set(n,!0),this._quadrant(s,n,i,-1,-1),this._quadrant(s,n,i,1,-1),this._quadrant(s,n,i,-1,1),this._quadrant(s,n,i,1,1),s},t.prototype._quadrant=function(t,e,i,r,o){var s=e.x,u=e.y,f=(Math.min(Math.max(s+r*(i+1),-1),this._size.width)-s)*r,a=(Math.min(Math.max(u+o*(i+1),-1),this._size.height)-u)*o;if(!(f<0||a<0))for(var c=this._size.index(e),p=t.index(e),d=[0,Number.POSITIVE_INFINITY],y=0,l=c,g=p;y!==a&&d.length>0;y++,l+=o*this._size.width,g+=o*t.width)for(var b=1/(y+.5),_=0===y?Number.POSITIVE_INFINITY:1/(y-.5),O=0,v=0,w=l,m=g,x=-.5*b,z=.5*_;v!==f&&O!==d.length;v++,w+=r,m+=r,x+=b,z+=_){for(;x>=d[O+1]&&!((O+=2)>=d.length););if(O>=d.length)break;z<=d[O+0]||(t.setAt(m,!0),(0!==v||0!==y)&&0!=(this._tileFlags[w>>5]&1<<(31&w))&&(O=h(d,O,x+n,z-n)))}},t}();function h(t,e,i,r){for(;;){if(e===t.length)return e;if(i<=t[e+1])break;e+=2}if(i<=t[e+0]){if(r>=t[e+1])return t.splice(e,2),h(t,e,i,r);r>=t[e+0]&&(t[e+0]=r)}else{if(r>=t[e+1])return t[e+1]=i,h(t,e+=2,i,r);t.splice(e,0,t[e+0],i),t[(e+=2)+0]=r}return e}e.FieldOfViewMap=s},842:function(t,e,i){var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||r(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(803),e),n(i(304),e),n(i(180),e),n(i(501),e),n(i(109),e)},109:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MaskRect=void 0;var r=i(842),n=new r.Offset,o=function(){function t(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this._rectangle=new r.Rectangle,this._rectangle.copyFrom(t),this._mask=new r.Mask(t,e),this._outsideValue=i}return t.prototype.toString=function(){return this._rectangle.northWest+"/"+this._outsideValue+"\n"+this._mask},Object.defineProperty(t.prototype,"westX",{get:function(){return this._rectangle.westX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northY",{get:function(){return this._rectangle.northY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._rectangle.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._rectangle.height},enumerable:!1,configurable:!0}),t.prototype.index=function(t){return this._mask.index(n.copyFrom(t).subtractOffset(this._rectangle.northWest))},t.prototype.getAt=function(t){return this._mask.getAt(t)},t.prototype.get=function(t,e){return n.set(t,e),this._rectangle.containsOffset(n)?this._mask.get(n.subtractOffset(this._rectangle.northWest)):this._outsideValue},t.prototype.setAt=function(t,e){return this._mask.setAt(t,e),this},t.prototype.set=function(t,e){return this._mask.set(n.copyFrom(t).subtractOffset(this._rectangle.northWest),e),this},t.prototype.forEach=function(t,e){var i=this;this._mask.forEach(t,(function(t,r){e(t.addOffset(i._rectangle.northWest),r)}))},t}();e.MaskRect=o},501:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mask=void 0;var r=i(842),n=function(){function t(t,e){void 0===e&&(e=!1),this._size=new r.Size,this._size.copyFrom(t),this._bits=new Array(this._size.area).fill(e)}return t.prototype.toString=function(){for(var t="",e=new r.Offset,i=0;i<this._size.height;i++){for(var n=0;n<this._size.width;n++)e.set(n,i),t+=this.get(e.set(n,i))?"☑":"☐";t+="\n"}return t},Object.defineProperty(t.prototype,"width",{get:function(){return this._size.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size.height},enumerable:!1,configurable:!0}),t.prototype.index=function(t){return this._size.index(t)},t.prototype.getAt=function(t){return this._bits[t]},t.prototype.get=function(t){return this.getAt(this.index(t))},t.prototype.setAt=function(t,e){return this._bits[t]=e,this},t.prototype.set=function(t,e){return this.setAt(this.index(t),e)},t.prototype.forEach=function(t,e){var i=this,r=0;this._size.forEach(t,(function(t){e(t,i._bits[r]),r++}))},t}();e.Mask=n},803:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Offset=void 0;var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.addOffset=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtractOffset=function(t){return this.x-=t.x,this.y-=t.y,this},t}();e.Offset=i},180:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=void 0;var r=i(842),n=new r.Offset,o=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.northWest=new r.Offset(t,e),this.size=new r.Size(i,n)}return t.prototype.toString=function(){return"("+this.westX+","+this.northY+" "+this.width+"x"+this.height+")"},Object.defineProperty(t.prototype,"northY",{get:function(){return this.northWest.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southY",{get:function(){return this.northWest.y+this.size.height-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"westX",{get:function(){return this.northWest.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eastX",{get:function(){return this.northWest.x+this.size.width-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.size.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.size.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.size.area},enumerable:!1,configurable:!0}),t.prototype.copyFrom=function(t){return this.northWest.set(t.westX,t.northY),this.size.set(t.width,t.height),this},t.prototype.containsOffset=function(t){return this.size.containsOffset(n.copyFrom(t).subtractOffset(this.northWest))},t.prototype.index=function(t){return this.size.index(n.copyFrom(t).subtractOffset(this.northWest))},t}();e.Rectangle=o},304:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Size=void 0;var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.width=t,this.height=e}return t.prototype.toString=function(){return"("+this.width+"x"+this.height+")"},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.width||0===this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){return this.width=t,this.height=e,this},t.prototype.copyFrom=function(t){return this.width=t.width,this.height=t.height,this},t.prototype.containsOffset=function(t){return t.x>=0&&t.y>=0&&t.x<this.width&&t.y<this.height},t.prototype.index=function(t){return t.y*this.width+t.x},t.prototype.forEach=function(t,e){for(var i=0;i<this.height;i++)for(var r=0;r<this.width;r++)t.x=r,t.y=i,e(t)},t}();e.Size=i},607:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MaskRect=e.FieldOfViewMap=void 0;var r=i(172);Object.defineProperty(e,"FieldOfViewMap",{enumerable:!0,get:function(){return r.FieldOfViewMap}});var n=i(842);Object.defineProperty(e,"MaskRect",{enumerable:!0,get:function(){return n.MaskRect}})}},e={};return function i(r){if(e[r])return e[r].exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,i),n.exports}(607)})();
//# sourceMappingURL=the-field-1.0.6.min.js.map